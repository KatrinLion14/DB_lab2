### DB_lab2

Лабораторная работа №2  
Выполнила: Хорошавина Екатерина 19ПИ-2  

#### 1.    Придумать свою предметную область и продумать схему БД для неё.

В качестве предметной области я выбрала персонал некой компании, сотрудники которой разделены на отделы. Первая таблица включает в себя список отделов, каждый определяется ID, названием и временем последнего изменения. Во второй хранятся данные о сотрудниках: ID, должность, ФИО и отдел (его ID).

Схема: 

![schema](https://github.com/KatrinLion14/DB_lab2/blob/main/%D1%81%D1%85%D0%B5%D0%BC%D0%B0.png)

#### 2.    Реализовать реляционную БД для своей предметной области (все таблицы должны быть не менее чем в третьей нормальной форме)

#### 3.    Критерии к БД:
[1]     БД должна быть в третьей нормальной форме или выше;

"Каждый неключевой атрибут должен предоставлять информацию о ключе, полном ключе и ни о чём, кроме ключа". В таблицах отсутсвуют неключевые столбцы, которые зависят от других неключевых столбцов. Кроме этого, отделы и должности в таблице персонала не уникальны.

[2]     Минимальное количество таблиц – 2;

[3]     Все подключения из GUI должны осуществляться выделенным, не root, пользователем;

Есть возможность подключиться каким-либо пользователем, по умолчанию уже созданный newuser.

[4]     Должен существовать как минимум один индекс, созданный вами по выбранному текстовому не ключевому полю;

В качестве индекса было выбрано поле ФИО у персонала.
```sql
create index if not exists FIO on "Person" (FIO);
```

[5]     В одной из таблиц должно присутствовать поле, заполняемое/изменяемое только триггером (например, «общая стоимость бронирования» в таблице «бронирования», которое автоматически высчитывается при добавлении/изменении/удалении билетов, входящих в это бронирование)

last_update меняется после каждого обновления информации об отделе. 
```sql
create or replace function update_time()
			returns trigger as $u$
			begin
				new.last_update = current_timestamp;
				return new;
			end;
		$u$ language plpgsql;

		drop trigger if exists trigger_update on "Department";

		create trigger trigger_update before update on "Department"
			for row execute procedure update_time();
```

#### 4.    Реализовать программу GUI со следующим функционалом:

[1]     Создание базы данных (важно(!) именно create database, а не только create table)

[2]     Удаление базы данных

[3]     Вывод содержимого таблиц

[4]     Очистка(частичная - одной, и полная - всех) таблиц

[5]     Добавление новых данных

[6]     Поиск по заранее выбранному (вами) текстовому не ключевому полю

[7]     Обновление кортежа

[8]     Удаление по заранее выбранному текстовому не ключевому полю

[9]     Удаление конкретной записи, выбранной пользователем

[10]     Все функции должны быть реализованы как хранимые процедуры. 
 
#### 5. Структура проекта: 
 
 - functions.sql (здесь хранятся функции)
 - start_window.py (дизайн стартового окна)
 - design.py (дизайн главного окна)
 - database.py (подключение к бд и т.п.)
 - gui.py (подключает к дизайну функции)
 - main.py (файл запуска)
 
#### Приложение:
 
 Стартовое окно

![start_window](https://github.com/KatrinLion14/DB_lab2/blob/main/start_window_photo.png)

Главное окно

![main_window](https://github.com/KatrinLion14/DB_lab2/blob/main/main_window_photo.png)

[Демонстрация работы](https://youtu.be/TuLbUYioEO4)
